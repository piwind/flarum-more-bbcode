(()=>{var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["admin/app"];var n=t.n(e);function i(){return i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},i.apply(this,arguments)}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}const s=flarum.core.compat["admin/components/ExtensionPage"];var l=t.n(s);const a=flarum.core.compat["common/components/Button"];var r=t.n(a);const c=flarum.core.compat["common/components/Checkbox"];var d=t.n(c);const u=flarum.core.compat["common/components/Alert"];var p=t.n(u),g=new Set(["cloud","detail","tabs","size","color","audio","download","clip","gdoc","litedown","table","spoiler","bold","italic","underline","strike_through","url","image","imagebb","email","code","quote","list-ul","list-ol","color","size","align-left","align-right","align-center","align","align-center","align-left","align-right","justify","background","subscript","superscript","strike-through","underline","horizontal-line","acronym","iframe","padding-left","padding-right","image-right","image-center","image-right","dropcap","indent","progress","alert","reply","login","login","like"]);function b(t,e){var i=n().translator.trans("xypp-more-bbcode.admin."+t,e);return Array.isArray(i)?i.join(""):i}var h=function(t){var e,n;function s(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).disables={},e.cloud=[],e.setting_disables=void 0,e.setting_cloud=void 0,e.saving=!1,e}n=t,(e=s).prototype=Object.create(n.prototype),e.prototype.constructor=e,o(e,n);var l=s.prototype;return l.oninit=function(e){var n=this;t.prototype.oninit.call(this,e),this.setting_disables=this.setting("xypp-more-bbcode.disable"),this.setting_cloud=this.setting("xypp-more-bbcode.cloud"),this.disables=JSON.parse(this.setting_disables()||"{}");var o=JSON.parse(this.setting_cloud());Object.keys(o).forEach((function(t){n.cloud.push(i({},o[t],{key:t}))}))},l.oncreate=function(e){t.prototype.oncreate.call(this,e)},l.content=function(t){var e=this;return m("div",{className:"xypp-more-bbcode-adminPage-container container"},m(p(),{dismissible:!1,type:"warning"},b("settings.tip")),m("h2",null,b("settings.misc.title")),this.buildSettingComponent({setting:"xypp-more-bbcode.remove-markdown",label:b("settings.misc.remove-markdown.title"),type:"select",options:{none:b("settings.misc.remove-markdown.none"),phone:b("settings.misc.remove-markdown.phone"),tablet:b("settings.misc.remove-markdown.tablet"),all:b("settings.misc.remove-markdown.all")}}),this.buildSettingComponent({setting:"xypp-more-bbcode.collect-all",label:b("settings.misc.collect-all.title"),type:"select",options:{none:b("settings.misc.collect-all.none"),phone:b("settings.misc.collect-all.phone"),tablet:b("settings.misc.collect-all.tablet"),all:b("settings.misc.collect-all.all")}}),this.buildSettingComponent({setting:"xypp-more-bbcode.collect-markdown",label:b("settings.misc.collect-markdown.title"),type:"select",options:{none:b("settings.misc.collect-markdown.none"),first:b("settings.misc.collect-markdown.first"),sub:b("settings.misc.collect-markdown.sub")}}),this.buildSettingComponent({setting:"xypp-more-bbcode.pref-markdown",label:b("settings.misc.pref-markdown.title"),type:"select",options:{none:b("settings.misc.pref-markdown.none"),collected:b("settings.misc.pref-markdown.collected"),all:b("settings.misc.pref-markdown.all")}}),m("h2",null,b("settings.functions.title")),m("div",{className:"xypp-more-bbcode-function"},this.getFunctionCheckboxes()),m("h2",null,b("settings.cloud.title")),m("table",{className:"Table Table--full"},m("thead",null,m("tr",null,m("th",null,b("settings.cloud.key")),m("th",null,b("settings.cloud.name")),m("th",null,b("settings.cloud.image")),m("th",null,b("settings.cloud.content")),m("th",null))),m("tbody",null,this.cloud.map((function(t,n){return m("tr",{key:n},m("td",null,m("input",{className:"FormControl",type:"text",value:t.key,onchange:function(t){e.cloud[n].key=t.target.value}.bind(e)})),m("td",null,m("input",{className:"FormControl",type:"text",value:t.name,onchange:function(t){e.cloud[n].name=t.target.value}.bind(e)})),m("td",null,m("input",{className:"FormControl",type:"text",value:t.image,onchange:function(t){e.cloud[n].image=t.target.value}.bind(e)})),m("td",null,m("input",{className:"FormControl",type:"text",value:t.content,onchange:function(t){e.cloud[n].content=t.target.value}.bind(e)})),m("td",null,m(r(),{onclick:function(){confirm(b("settings.cloud.confirm"))||e.cloud.splice(n,1),m.redraw()}.bind(e)},m("i",{className:"fas fa-trash"}))))})),m("tr",null,m("td",null,m(r(),{className:"Button Button--secondary",onclick:this.addRow.bind(this)},b("settings.cloud.add")))))),m(r(),{className:"Button Button--primary",onclick:this.save.bind(this),disabled:this.saving,loading:this.saving},b("settings.save")))},l.getFunctionCheckboxes=function(){var t=this,e=[];return g.forEach((function(n){e.push(d().component({onchange:t.changeStateCbMaker(n),state:!t.disables[n]},n))})),e},l.changeStateCbMaker=function(t){var e=this;return function(n){n?e.disables[t]&&delete e.disables[t]:e.disables[t]=!0}.bind(this)},l.addRow=function(){this.cloud.push({name:"",image:"",key:"new",content:""})},l.save=function(t){var e=this;this.saving=!0,m.redraw();var n={};this.cloud.forEach((function(t){n[t.key]={name:t.name,image:t.image,content:t.content}})),this.setting_cloud(JSON.stringify(n)),this.setting_disables(JSON.stringify(this.disables)),this.saveSettings(t).then((function(){e.saving=!1,m.redraw()}))},s}(l());n().initializers.add("xypp/flarum-more-bbcode",(function(){n().extensionData.for("xypp-more-bbcode").registerPage(h).registerPermission({icon:"fas fa-eye-slash",label:n().translator.trans("xypp-more-bbcode.admin.permissions.bypass_reply_label"),permission:"post.bypassReplyRequirement"},"view").registerPermission({icon:"fas fa-eye-slash",label:n().translator.trans("xypp-more-bbcode.admin.permissions.bypass_like_label"),permission:"post.bypassLikeRequirement"},"view")}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map